select materia, industria, count()/(select count() from empresas where industria in (select distinct industria from empresas ) ) as proba from empresas where materia in (select distinct materia from empresas) group by materia, industria